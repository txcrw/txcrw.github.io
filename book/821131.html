<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><script type="text/javascript" src="https://file.bkxsj.com/skin/book/js/sk.js"></script><meta name="robots" content="index,follow"><title>Windows内核安全与驱动开发[PDF|Epub|txt|kindle电子书版本网盘下载]-灵感之桥</title><meta name="Keywords" content="Windows内核安全与驱动开发"/><meta name="description" content="Windows内核安全与驱动开发pdf下载文件大小为80MB,PDF页数为681页"/><meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE;chrome=1"><link type="image/x-icon" rel="shortcut icon" href="https://www.shukui.net/skin/book/images/favicon.ico"><link type="text/css" rel="stylesheet" href="https://www.shukui.net/skin/book/css/style.css"><style>#main .d-main {margin-left: 0;width: 620px;}.down-btn {animation: myShake 2.5s linear .15s infinite}@keyframes myShake {0%, 66% {transform: translateZ(0)}67%, 73.6%, 83.6%, 93.6%, to {animation-timing-function: cubic-bezier(.215, .61, .355, 1);transform: translateZ(0)}80.3%, 81.4% {animation-timing-function: cubic-bezier(.755, .05, .855, .06);transform: translate3d(0, -4px, 0)}90.3% {animation-timing-function: cubic-bezier(.755, .05, .855, .06);transform: translate3d(0, -2px, 0)}97% {transform: translate3d(0, -.5px, 0)}}.copylink-btn {margin-right: 20px;}.copymd5-btn {margin-bottom: 25px;margin-left: 10px;}</style></head><body><div id="header"><div class="inner"><div class="logo"><a href="/"><img width="103" height="25" alt="灵感之桥"src="https://www.shukui.net/skin/book/images/logo.png"></a></div><div class="search"><form action="/so/search.php" target="_blank"><input type="text" autocomplete="off" id="bdcsMain" name="q" placeholder="书名 / 作者 / 出版社 / ISBN"class="inp-txt"><select class="inp-select" id="datasource" onchange="selectDatasource(this)"><option value="so">主库</option><option value="s">从库</option></select><input type="submit" value="搜索" class="inp-btn"></form></div></div></div><div id="main"><div class="d-main"><div class="tit"><h3>图书介绍</h3></div><h1 class="book-name">Windows内核安全与驱动开发PDF|Epub|txt|kindle电子书版本网盘下载</h1><div class="d-info"><div class="b-thumb"><img src="https://www.shukui.net/cover/21/30904098.jpg" alt="Windows内核安全与驱动开发"></div><div class="b-info"><ul><li>谭文，陈铭霖等著 著</li><li>出版社： 北京：电子工业出版社</li><li>ISBN：9787121262159</li><li>出版时间：2015</li><li>标注页数：664页</li><li>文件大小：80MB</li><li>文件页数：681页</li><li>主题词：Windows操作系统－程序设计</li></ul></div></div><div class="tit"><h3>PDF下载</h3></div><div></br><a style="color:red;" rel="external nofollow" href="https://www.kjlm.net/ebook/821133.html"target="_blank"><b>点此进入-本书在线PDF格式电子书下载【推荐-云解压-方便快捷】直接下载PDF格式图书。移动端-PC端通用</a></b></br><a class="down-btn" rel="external nofollow" href="https://down.trackerbk.com/bt/02/30904098.torrent"target="_blank">种子下载</a>[BT下载速度快]温馨提示：（请使用BT下载软件FDM进行下载）<a rel="nofollow" href="https://www.freedownloadmanager.org/zh/" target="_blank">软件下载地址页</a><a class="down-btn" rel="external nofollow" href="https://down.p2spdb.com/02/30904098.rar" target="_blank">直链下载</a>[便捷但速度慢]&nbsp;&nbsp;<a style="color:red;" rel="external nofollow" href="https://pdfyl.ertongbook.com/19/30904098.pdf" target="_blank"><b>[在线试读本书]</b></a>&nbsp;&nbsp;<b> <a style="color:red;" rel="external nofollow" href="https://web.jyjl.org/index/recovery.html" target="_blank">[在线获取解压码]</a></b><div class="copymd5-btn"><a href="javascript:copyToClip('9ac50b8e84f9e7cc9d173724d5c70063')">点击复制MD5值：9ac50b8e84f9e7cc9d173724d5c70063</a></div></div><div class="tit"><h3>下载说明</h3></div><div style="margin:20px 10px"><h2>Windows内核安全与驱动开发PDF格式电子书版下载</h2>下载的文件为RAR压缩包。需要使用解压软件进行解压得到PDF格式图书。<br><br><div class="copymd5-btn"><a href="javascript:copyToClip('magnet:?xt=urn:btih:RX6G6JQ2LJW7PBBEDNUSCQM7ICDMHIWK')">点击复制85GB完整离线版磁力链接到迅雷FDM等BT下载工具进行下载</a>&nbsp;&nbsp;<a rel="nofollow" target="_blank">详情点击-查看共享计划</a></div>建议使用BT下载工具Free Download Manager进行下载,简称FDM(免费,没有广告,支持多平台）。本站资源全部打包为BT种子。所以需要使用专业的BT下载软件进行下载。如BitComet qBittorrent uTorrent等BT下载工具。迅雷目前由于本站不是热门资源。不推荐使用！后期资源热门了。安装了迅雷也可以迅雷进行下载！<br><br><b>（文件页数 要大于 标注页数，上中下等多册电子书除外）</b><br><br><p style="color:red;"> <b>注意：本站所有压缩包均有解压码：</b> <a rel="nofollow" target="_blank"><b>点击下载压缩包解压工具</b></a></p></div><div class="tit"><h3>图书目录</h3></div><div id="book-contents"><p>基础篇2</p><p>第1章 内核上机指导2</p><p>1.1 下载和使用WDK2</p><p>1.1.1 下载并安装WDK2</p><p>1.1.2 编写第一个C文件4</p><p>1.1.3 编译一个工程5</p><p>1.2 安装与运行6</p><p>1.2.1 下载一个安装工具6</p><p>1.2.2 运行与查看输出信息7</p><p>1.2.3 在虚拟机中运行8</p><p>1.3 调试内核模块9</p><p>1.3.1 下载和安装WinDbg9</p><p>1.3.2 设置Windows XP调试执行9</p><p>1.3.3 设置Vista调试执行10</p><p>1.3.4 设置VMware的管道虚拟串口11</p><p>1.3.5 设置Windows内核符号表12</p><p>1.3.6 实战调试first13</p><p>第2章 内核编程环境及其特殊性16</p><p>2.1 内核编程的环境16</p><p>2.1.1 隔离的应用程序16</p><p>2.1.2 共享的内核空间17</p><p>2.1.3 无处不在的内核模块18</p><p>2.2 数据类型19</p><p>2.2.1 基本数据类型19</p><p>2.2.2 返回状态19</p><p>2.2.3 字符串20</p><p>2.3 重要的数据结构21</p><p>2.3.1 驱动对象21</p><p>2.3.2 设备对象22</p><p>2.3.3 请求24</p><p>2.4 函数调用25</p><p>2.4.1 查阅帮助25</p><p>2.4.2 帮助中有的几类函数26</p><p>2.4.3 帮助中没有的函数28</p><p>2.5 Windows的驱动开发模型29</p><p>2.6 WDK编程中的特殊点30</p><p>2.6.1 内核编程的主要调用源30</p><p>2.6.2 函数的多线程安全性30</p><p>2.6.3 代码的中断级32</p><p>2.6.4 WDK中出现的特殊代码32</p><p>第3章 字符串与链表35</p><p>3.1 字符串操作35</p><p>3.1.1 使用字符串结构35</p><p>3.1.2 字符串的初始化36</p><p>3.1.3 字符串的拷贝37</p><p>3.1.4 字符串的连接38</p><p>3.1.5 字符串的打印38</p><p>3.2 内存与链表40</p><p>3.2.1 内存的分配与释放40</p><p>3.2.2 使用LIST＿ENTRY41</p><p>3.2.3 使用长长整型数据43</p><p>3.3 自旋锁44</p><p>3.3.1 使用自旋锁44</p><p>3.3.2 在双向链表中使用自旋锁45</p><p>3.3.3 使用队列自旋锁提高性能46</p><p>第4章 文件、注册表、线程47</p><p>4.1 文件操作47</p><p>4.1.1 使用OBJECT＿ATTRIBUTES47</p><p>4.1.2 打开和关闭文件48</p><p>4.1.3 文件读/写操作51</p><p>4.2 注册表操作53</p><p>4.2.1 注册表键的打开53</p><p>4.2.2 注册表键值的读55</p><p>4.2.3 注册表键值的写57</p><p>4.3 时间与定时器58</p><p>4.3.1 获得当前“滴答”数58</p><p>4.3.2 获得当前系统时间58</p><p>4.3.3 使用定时器59</p><p>4.4 线程与事件62</p><p>4.4.1 使用系统线程62</p><p>4.4.2 在线程中睡眠63</p><p>4.4.3 使用同步事件64</p><p>第5章 应用与内核通信67</p><p>5.1 内核方面的编程68</p><p>5.1.1 生成控制设备68</p><p>5.1.2 控制设备的名字和符号链接70</p><p>5.1.3 控制设备的删除71</p><p>5.1.4 分发函数72</p><p>5.1.5 请求的处理73</p><p>5.2 应用方面的编程74</p><p>5.2.1 基本的功能需求74</p><p>5.2.2 在应用程序中打开与关闭设备75</p><p>5.2.3 设备控制请求75</p><p>5.2.4 内核中的对应处理77</p><p>5.2.5 结合测试的效果79</p><p>5.3 阻塞、等待与安全设计80</p><p>5.3.1 驱动主动通知应用80</p><p>5.3.2 通信接口的测试81</p><p>5.3.3 内核中的缓冲区链表结构83</p><p>5.3.4 输入：内核中的请求处理中的安全检查84</p><p>5.3.5 输出处理与卸载清理85</p><p>第6章 64位和32位内核开发差异88</p><p>6.1 64位系统新增机制88</p><p>6.1.1 WOW64子系统88</p><p>6.1.2 PatchGuard技术91</p><p>6.1.3 64位驱动的编译、安装与运行91</p><p>6.2 编程差异92</p><p>6.2.1 汇编嵌入变化92</p><p>6.2.2 预处理与条件编译93</p><p>6.2.3 数据结构调整93</p><p>开发篇96</p><p>第7章 串口的过滤96</p><p>7.1 过滤的概念96</p><p>7.1.1 设备绑定的内核API之一97</p><p>7.1.2 设备绑定的内核API之二98</p><p>7.1.3 生成过滤设备并绑定98</p><p>7.1.4 从名字获得设备对象100</p><p>7.1.5 绑定所有串口101</p><p>7.2 获得实际数据102</p><p>7.2.1 请求的区分102</p><p>7.2.2 请求的结局103</p><p>7.2.3 写请求的数据104</p><p>7.3 完整的代码105</p><p>7.3.1 完整的分发函数105</p><p>7.3.2 如何动态卸载106</p><p>7.3.3 代码的编译与运行107</p><p>第8章 键盘的过滤109</p><p>8.1 技术原理110</p><p>8.1.1 预备知识110</p><p>8.1.2 Windows中从击键到内核110</p><p>8.1.3 键盘硬件原理112</p><p>8.2 键盘过滤的框架112</p><p>8.2.1 找到所有的键盘设备112</p><p>8.2.2 应用设备扩展115</p><p>8.2.3 键盘过滤模块的DriverEntry117</p><p>8.2.4 键盘过滤模块的动态卸载117</p><p>8.3 键盘过滤的请求处理119</p><p>8.3.1 通常的处理119</p><p>8.3.2 PNP的处理120</p><p>8.3.3 读的处理121</p><p>8.3.4 读完成的处理122</p><p>8.4 从请求中打印出按键信息123</p><p>8.4.1 从缓冲区中获得 KEYBOARD＿INPUT＿DATA123</p><p>8.4.2 从KEYBOARD＿INPUT＿DATA中得到键124</p><p>8.4.3 从MakeCode到实际字符124</p><p>8.5 Hook分发函数126</p><p>8.5.1 获得类驱动对象126</p><p>8.5.2 修改类驱动的分发函数指针127</p><p>8.5.3 类驱动之下的端口驱动128</p><p>8.5.4 端口驱动和类驱动之间的协作机制129</p><p>8.5.5 找到关键的回调函数的条件129</p><p>8.5.6 定义常数和数据结构130</p><p>8.5.7 打开两种键盘端口驱动寻找设备131</p><p>8.5.8 搜索在KbdClass类驱动中的地址133</p><p>8.6 Hook键盘中断反过滤135</p><p>8.6.1 中断：IRQ和INT136</p><p>8.6.2 如何修改IDT136</p><p>8.6.3 替换IDT中的跳转地址137</p><p>8.6.4 QQ的PS/2反过滤措施139</p><p>8.7 直接用端口操作键盘139</p><p>8.7.1 读取键盘数据和命令端口139</p><p>8.7.2 p2cUserFilter的最终实现140</p><p>第9章 磁盘的虚拟143</p><p>9.1 虚拟的磁盘143</p><p>9.2 一个具体的例子143</p><p>9.3 入口函数144</p><p>9.3.1 入口函数的定义144</p><p>9.3.2 Ramdisk驱动的入口函数145</p><p>9.4 EvtDriverDeviceAdd函数146</p><p>9.4.1 EvtDriverDeviceAdd的定义146</p><p>9.4.2 局部变量的声明146</p><p>9.4.3 磁盘设备的创建147</p><p>9.4.4 如何处理发往设备的请求148</p><p>9.4.5 用户配置的初始化149</p><p>9.4.6 链接给应用程序151</p><p>9.4.7 小结152</p><p>9.5 FAT12/16磁盘卷初始化152</p><p>9.5.1 磁盘卷结构简介152</p><p>9.5.2 Ramdisk对磁盘的初始化154</p><p>9.6 驱动中的请求处理160</p><p>9.6.1 请求的处理160</p><p>9.6.2 读/写请求160</p><p>9.6.3 DeviceIoControl请求162</p><p>9.7 Ramdisk的编译和安装164</p><p>9.7.1 编译164</p><p>9.7.2 安装164</p><p>9.7.3 对安装的深入探究165</p><p>第10章 磁盘的过滤167</p><p>10.1 磁盘过滤驱动的概念167</p><p>10.1.1 设备过滤和类过滤167</p><p>10.1.2 磁盘设备和磁盘卷设备过滤驱动167</p><p>10.1.3 注册表和磁盘卷设备过滤驱动168</p><p>10.2 具有还原功能的磁盘卷过滤驱动168</p><p>10.2.1 简介168</p><p>10.2.2 基本思想169</p><p>10.3 驱动分析169</p><p>10.3.1 DriverEntry函数169</p><p>10.3.2 AddDevice函数170</p><p>10.3.3 PnP请求的处理174</p><p>10.3.4 Power请求的处理178</p><p>10.3.5 DeviceIoControl请求的处理178</p><p>10.3.6 bitmap的作用和分析182</p><p>10.3.7 boot驱动完成回调函数和稀疏文件187</p><p>10.3.8 读/写请求的处理190</p><p>第11章 文件系统的过滤与监控199</p><p>11.1 文件系统的设备对象200</p><p>11.1.1 控制设备与卷设备200</p><p>11.1.2 生成自己的一个控制设备201</p><p>11.2 文件系统的分发函数202</p><p>11.2.1 普通的分发函数202</p><p>11.2.2 文件过滤的快速IO分发函数203</p><p>11.2.3 快速IO分发函数的一个实现205</p><p>11.2.4 快速IO分发函数逐个简介206</p><p>11.3 设备的绑定前期工作207</p><p>11.3.1 动态地选择绑定函数207</p><p>11.3.2 注册文件系统变动回调208</p><p>11.3.3 文件系统变动回调的一个实现209</p><p>11.3.4 文件系统识别器211</p><p>11.4 文件系统控制设备的绑定212</p><p>11.4.1 生成文件系统控制设备的过滤设备212</p><p>11.4.2 绑定文件系统控制设备213</p><p>11.4.3 利用文件系统控制请求215</p><p>11.5 文件系统卷设备的绑定217</p><p>11.5.1 从IRP中获得VPB指针217</p><p>11.5.2 设置完成函数并等待IRP完成218</p><p>11.5.3 卷挂载IRP完成后的工作221</p><p>11.5.4 完成函数的相应实现223</p><p>11.5.5 绑定卷的实现224</p><p>11.6 读/写操作的过滤226</p><p>11.6.1 设置一个读处理函数226</p><p>11.6.2 设备对象的区分处理227</p><p>11.6.3 解析读请求中的文件信息228</p><p>11.6.4 读请求的完成230</p><p>11.7 其他操作的过滤234</p><p>11.7.1 文件对象的生存周期234</p><p>11.7.2 文件的打开与关闭235</p><p>11.7.3 文件的删除237</p><p>11.8 路径过滤的实现238</p><p>11.8.1 取得文件路径的三种情况238</p><p>11.8.2 打开成功后获取路径238</p><p>11.8.3 在其他时刻获得文件路径240</p><p>11.8.4 在打开请求完成之前获得路径名240</p><p>11.8.5 把短名转换为长名242</p><p>11.9 把sfilter编译成静态库243</p><p>11.9.1 如何方便地使用sfilter243</p><p>11.9.2 初始化回调、卸载回调和绑定回调244</p><p>11.9.3 绑定与回调245</p><p>11.9.4 插入请求回调246</p><p>11.9.5 如何利用sfilter．lib249</p><p>第12章 文件系统透明加密252</p><p>12.1 文件透明加密的应用252</p><p>12.1.1 防止企业信息泄密252</p><p>12.1.2 文件透明加密防止企业信息泄密253</p><p>12.1.3 文件透明加密软件的例子253</p><p>12.2 区分进程254</p><p>12.2.1 机密进程与普通进程254</p><p>12.2.2 找到进程名字的位置255</p><p>12.2.3 得到当前进程的名字256</p><p>12.3 内存映射与文件缓冲257</p><p>12.3.1 记事本的内存映射文件257</p><p>12.3.2 Windows的文件缓冲258</p><p>12.3.3 文件缓冲：明文还是密文的选择259</p><p>12.3.4 清除文件缓冲260</p><p>12.4 加密标识263</p><p>12.4.1 保存在文件外、文件头还是文件尾263</p><p>12.4.2 隐藏文件头的大小264</p><p>12.4.3 隐藏文件头的设置偏移266</p><p>12.4.4 隐藏文件头的读/写偏移267</p><p>12.5 文件加密表267</p><p>12.5.1 何时进行加密操作267</p><p>12.5.2 文件控制块与文件对象268</p><p>12.5.3 文件加密表的数据结构与初始化269</p><p>12.5.4 文件加密表的操作：查询270</p><p>12.5.5 文件加密表的操作：添加271</p><p>12.5.6 文件加密表的操作：删除272</p><p>12.6 文件打开处理273</p><p>12.6.1 直接发送IRP进行查询与设置操作274</p><p>12.6.2 直接发送IRP进行读/写操作276</p><p>12.6.3 文件的非重入打开277</p><p>12.6.4 文件的打开预处理280</p><p>12.7 读/写加密和解密285</p><p>12.7.1 在读取时进行解密285</p><p>12.7.2 分配与释放MDI286</p><p>12.7.3 写请求加密287</p><p>12.8 crypt＿file的组装289</p><p>12.8.1 crypt＿file的初始化289</p><p>12.8.2 crypt＿file的IRP预处理290</p><p>12.8.3 crypt＿file的IRP后处理293</p><p>第13章 文件系统微过滤驱动297</p><p>13.1 文件系统微过滤驱动简介297</p><p>13.1.1 文件系统微过滤驱动的由来297</p><p>13.1.2 Minifilter的优点与不足298</p><p>13.2 Minifilter的编程框架298</p><p>13.2.1 微文件系统过滤的注册299</p><p>13.2.2 微过滤器的数据结构300</p><p>13.2.3 卸载回调函数303</p><p>13.2.4 预操作回调函数303</p><p>13.2.5 后操作回调函数306</p><p>13.2.6 其他回调函数307</p><p>13.3 Minifilter如何与应用程序通信309</p><p>13.3.1 建立通信端口的方法310</p><p>13.3.2 在用户态通过DLL使用通信端口的范例311</p><p>13.4 Minifilter的安装与加载314</p><p>13.4.1 安装Minifilter的INF文件314</p><p>13.4.2 启动安装完成的Minifilter316</p><p>第14章 网络传输层过滤317</p><p>14.1 TDI概要317</p><p>14.1.1 为何选择TDI317</p><p>14.1.2 从socket到Windows内核318</p><p>14.1.3 TDI过滤的代码例子319</p><p>14.2 TDI的过滤框架319</p><p>14.2.1 绑定TDI的设备319</p><p>14.2.2 唯一的分发函数320</p><p>14.2.3 过滤框架的实现322</p><p>14.2.4 主要过滤的请求类型323</p><p>14.3 生成请求：获取地址324</p><p>14.3.1 过滤生成请求324</p><p>14.3.2 准备解析IP地址与端口326</p><p>14.3.3 获取生成的IP地址和端口327</p><p>14.3.4 连接终端的生成与相关信息的保存329</p><p>14.4 控制请求330</p><p>14.4.1 TDI＿ASSOCIATE＿ADDRESS的过滤330</p><p>14.4.2 TDI＿CONNECT的过滤332</p><p>14.4.3 其他的次功能号333</p><p>14.4.4 设置事件的过滤334</p><p>14.4.5 TDI＿EVENT＿CONNECT类型的设置事件的过滤336</p><p>14.4.6 直接获取发送函数的过滤337</p><p>14.4.7 清理请求的过滤339</p><p>14.5 本书例子tdifw.lib的应用341</p><p>14.5.1 tdifw库的回调接口341</p><p>14.5.2 tdifw库的使用例子342</p><p>第15章 Windows过滤平台345</p><p>15.1 WFP简介345</p><p>15.2 WFP框架345</p><p>15.3 基本对象模型347</p><p>15.3.1 过滤引擎347</p><p>15.3.2 垫片347</p><p>15.3.3 呼出接口347</p><p>15.3.4 分层348</p><p>15.3.5 子层349</p><p>15.3.6 过滤器350</p><p>15.3.7 呼出接口回调函数354</p><p>15.4 WFP操作359</p><p>15.4.1 呼出接口的注册与卸载360</p><p>15.4.2 呼出接口的添加与移除360</p><p>15.4.3 子层的添加与移除361</p><p>15.4.4 过滤器的添加362</p><p>15.5 WFP过滤例子362</p><p>第16章 NDIS协议驱动370</p><p>16.1 以太网包和网络驱动架构370</p><p>16.1.1 以太网包和协议驱动370</p><p>16.1.2 NDIS网络驱动371</p><p>16.2 协议驱动的DriverEntry372</p><p>16.2.1 生成控制设备372</p><p>16.2.2 注册协议374</p><p>16.3 协议与网卡的绑定375</p><p>16.3.1 协议与网卡的绑定概念375</p><p>16.3.2 绑定回调处理的实现376</p><p>16.3.3 协议绑定网卡的API378</p><p>16.3.4 解决绑定竞争问题379</p><p>16.3.5 分配接收和发送的包池与缓冲池380</p><p>16.3.6 OID请求的发送和请求完成回调381</p><p>16.3.7 ndisprotCreateBinding的最终实现385</p><p>16.4 绑定的解除390</p><p>16.4.1 解除绑定使用的API390</p><p>16.4.2 ndisprotShutdownBinding的实现392</p><p>16.5 在用户态操作协议驱动395</p><p>16.5.1 协议的收包与发包395</p><p>16.5.2 在用户态编程打开设备396</p><p>16.5.3 用DeviceIoControl发送控制请求397</p><p>16.5.4 用WriteFile发送数据包399</p><p>16.5.5 用ReadFile发送数据包400</p><p>16.6 在内核态完成功能的实现402</p><p>16.6.1 请求的分发与实现402</p><p>16.6.2 等待设备绑定完成与指定设备名402</p><p>16.6.3 指派设备的完成403</p><p>16.6.4 处理读请求406</p><p>16.6.5 处理写请求408</p><p>16.7 协议驱动的接收回调412</p><p>16.7.1 和接收包有关的回调函数412</p><p>16.7.2 ReceiveHandler的实现413</p><p>16.7.3 TransferDataCompleteHandler的实现417</p><p>16.7.4 ReceivePacketHandler的实现418</p><p>16.7.5 接收数据包的入队420</p><p>16.7.6 接收数据包的出队和读请求的完成422</p><p>第17章 NDIS小端口驱动427</p><p>17.1 小端口驱动的应用与概述427</p><p>17.1.1 小端口驱动的应用427</p><p>17.1.2 小端口驱动示例428</p><p>17.1.3 小端口驱动的运作与编程概述429</p><p>17.2 小端口驱动的初始化429</p><p>17.2.1 小端口驱动的DriverEntry429</p><p>17.2.2 小端口驱动的适配器结构431</p><p>17.2.3 配置信息的读取433</p><p>17.2.4 设置小端口适配器上下文433</p><p>17.2.5 MPInitialize的实现434</p><p>17.2.6 MPHalt的实现437</p><p>17.3 打开ndisprot设备438</p><p>17.3.1 IO目标438</p><p>17.3.2 给IO目标发送DeviceIoControl请求439</p><p>17.3.3 打开ndisprot接口并完成配置设备441</p><p>17.4 使用ndisprot发送包443</p><p>17.4.1 小端口驱动的发包接口443</p><p>17.4.2 发送控制块（TCB）444</p><p>17.4.3 遍历包组并填写TCB446</p><p>17.4.4 写请求的构建与发送449</p><p>17.5 使用ndisprot接收包451</p><p>17.5.1 提交数据包的内核API451</p><p>17.5.2 从接收控制块（RCB）提交包452</p><p>17.5.3 对ndisprot读请求的完成函数454</p><p>17.5.4 读请求的发送456</p><p>17.5.5 用于读包的WDF工作任务457</p><p>17.5.6 ndisedge读工作任务的生成与入列459</p><p>17.6 其他的特征回调函数的实现461</p><p>17.6.1 包的归还461</p><p>17.6.2 OID查询处理的直接完成462</p><p>17.6.3 OID设置处理465</p><p>第18章 NDIS中间层驱动467</p><p>18.1 NDIS中间层驱动概述467</p><p>18.1.1 Windows网络架构总结467</p><p>18.1.2 NDIS中间层驱动简介468</p><p>18.1.3 NDIS中间层驱动的应用469</p><p>18.1.4 NDIS包描述符结构深究470</p><p>18.2 中间层驱动的入口与绑定473</p><p>18.2.1 中间层驱动的入口函数473</p><p>18.2.2 动态绑定NIC设备474</p><p>18.2.3 小端口初始化（MpInitialize）475</p><p>18.3 中间层驱动发送数据包477</p><p>18.3.1 发送数据包原理477</p><p>18.3.2 包描述符“重利用”478</p><p>18.3.3 包描述符“重申请”481</p><p>18.3.4 发送数据包的异步完成482</p><p>18.4 中间层驱动接收数据包484</p><p>18.4.1 接收数据包概述484</p><p>18.4.2 用PtReceive接收数据包485</p><p>18.4.3 用PtReceivePacket接收490</p><p>18.4.4 对包进行过滤491</p><p>18.5 中间层驱动程序查询和设置494</p><p>18.5.1 查询请求的处理494</p><p>18.5.2 设置请求的处理496</p><p>18.6 NDIS句柄498</p><p>18.6.1 不可见的结构指针498</p><p>18.6.2 常见的NDIS句柄499</p><p>18.6.3 NDIS句柄误用问题500</p><p>18.6.4 一种解决方案502</p><p>18.7 生成普通控制设备503</p><p>18.7.1 在中间层驱动中添加普通设备503</p><p>18.7.2 使用传统方法来生成控制设备505</p><p>第19章 IA-32汇编基础511</p><p>19.1 x86内存、寄存器与堆栈511</p><p>19.1.1 asm关键字511</p><p>19.1.2 x86中的mov指令512</p><p>19.1.3 x86中的寄存器与内存512</p><p>19.1.4 赋值语句的实现513</p><p>19.2 x86中函数的实现514</p><p>19.2.1 一个函数的例子514</p><p>19.2.2 堆栈的介绍515</p><p>19.2.3 寄存器的备份和恢复516</p><p>19.2.4 内部变量与返回值518</p><p>19.3 x86中函数的调用与返回521</p><p>19.3.1 函数的调用指令call521</p><p>19.3.2 通过堆栈传递参数521</p><p>19.3.3 从函数返回523</p><p>19.3.4 三种常见的调用协议524</p><p>19.4 从32位汇编到64位汇编526</p><p>19.4.1 Intel64与IA-32体系架构简介526</p><p>19.4.2 64位指令与32位指令526</p><p>19.4.3 通用寄存器527</p><p>19.5 64位下的函数实现528</p><p>19.5.1 函数概览528</p><p>19.5.2 32位参数的传递529</p><p>19.5.3 64位参数与返回值530</p><p>19.5.4 栈空间的开辟与恢复531</p><p>第20章 IA-32体系中的内存地址534</p><p>20.1 内存的虚拟地址534</p><p>20.1.1 C语言中的内存地址534</p><p>20.1.2 虚拟地址的构成535</p><p>20.1.3 段的选择536</p><p>20.2 全局描述符表和段描述符538</p><p>20.2.1 全局描述符表538</p><p>20.2.2 段类型539</p><p>20.2.3 段寄存器与段选择子540</p><p>20.2.4 64位模式下的段541</p><p>20.3 分段编程实践542</p><p>20.3.1 系统表寄存器的结构542</p><p>20.3.2 在汇编语言中获取全局描述表的位置543</p><p>20.3.3 调试范例：sgdt指令的错误使用545</p><p>20.3.4 在64位下获得全局描述符表547</p><p>20.4 线性地址基础549</p><p>20.4.1 分页控制机制550</p><p>20.4.2 线性地址的转换551</p><p>20.4.3 混合页面大小552</p><p>20.4.4 32位物理地址的页目录和页表项552</p><p>20.5 各种特殊分页方式555</p><p>20.5.1 PAE分页方式555</p><p>20.5.2 PSE-36分页机制558</p><p>20.5.3 IA-32e模式下的线性地址559</p><p>20.6 分页编程实践562</p><p>20.6.1 页目录和页目录指针表的获取562</p><p>20.6.2 页表的获取564</p><p>20.6.3 线性地址的结构567</p><p>第21章 处理器权限级别切换571</p><p>21.1 Ring0和Ring3权限级别571</p><p>21.2 保护模式下的分页内存保护572</p><p>21.3 分页内存不可执行保护574</p><p>21.3.1 不可执行保护原理574</p><p>21.3.2 不可执行保护的漏洞575</p><p>21.3.3 上机实践577</p><p>21.4 权限级别的切换579</p><p>21.4.1 调用门及其漏洞579</p><p>21.4.2 sysenter和sysexit指令581</p><p>21.4.3 上机实践583</p><p>第22章 IA-32体系结构中的中断585</p><p>22.1 中断基础知识585</p><p>22.1.1 中断描述符表585</p><p>22.1.2 中断处理过程587</p><p>22.1.3 64位模式下的中断处理机制589</p><p>22.1.4 多核下的中断589</p><p>22.2 Windows中断机制593</p><p>22.3 中断编程实践596</p><p>22.3.1 IDT Hook596</p><p>22.3.2 巧用IDT Hook实现安全防护598</p><p>第23章 Windows内核挂钩601</p><p>23.1 系统服务描述符表挂钩602</p><p>23.1.1 系统服务描述符表（SSDT）602</p><p>23.1.2 系统服务描述符表挂钩的意图603</p><p>23.1.3 寻找要挂钩的函数的地址604</p><p>23.1.4 函数被挂钩的过程605</p><p>23.1.5 具体实现的代码606</p><p>23.2 函数导出表挂钩608</p><p>23.2.1 内核函数的种类608</p><p>23.2.2 挂钩IoCallDriver610</p><p>23.2.3 对跳转地址进行修改611</p><p>23.3 Windows7系统下IofCallDriver的跟踪612</p><p>23.4 Windows7系统下内联挂钩615</p><p>23.4.1 写入跳转指令并拷贝代码615</p><p>23.4.2 实现中继函数617</p><p>高级篇620</p><p>第24章 Windows通知与回调620</p><p>24.1 Windows的事件通知与回调620</p><p>24.2 常用的事件通知620</p><p>24.2.1 创建进程通知621</p><p>24.2.2 创建线程通知625</p><p>24.2.3 加载模块通知626</p><p>24.2.4 注册表操作通知629</p><p>24.3 Windows回调机制636</p><p>24.3.1 回调对象636</p><p>24.3.2 回调对象的创建637</p><p>24.3.3 回调对象的注册637</p><p>24.3.4 回调的通告638</p><p>24.4 安全的死角，回调的应用639</p><p>第25章 保护进程640</p><p>25.1 内核对象简介640</p><p>25.2 内核对象的结构641</p><p>25.3 保护内核对象642</p><p>25.3.1 处理对象的打开643</p><p>25.3.2 处理句柄的复制644</p><p>25.3.3 处理句柄的继承646</p><p>25.4 进程的保护652</p><p>25.4.1 保护原理652</p><p>25.4.2 Vista以后的进程对象保护654</p><p>25.4.3 进程的其他保护655</p><p>附录A 如何使用本书的源码光盘656</p><p>附录B 练习题659</p><p></p></div></div><div class="d-rt"><h3>热门推荐</h3><ul><li><a href="/book/55412.html">55412.html</a></li><li><a href="/book/3880107.html">3880107.html</a></li><li><a href="/book/3266130.html">3266130.html</a></li><li><a href="/book/3653274.html">3653274.html</a></li><li><a href="/book/2797341.html">2797341.html</a></li><li><a href="/book/2811994.html">2811994.html</a></li><li><a href="/book/126062.html">126062.html</a></li><li><a href="/book/3823849.html">3823849.html</a></li><li><a href="/book/872432.html">872432.html</a></li><li><a href="/book/1172776.html">1172776.html</a></li></ul></div></div><div id="footer"><p>Copyright&nbsp;&copy;&nbsp;2025&nbsp;&nbsp;<a href="/list/">最新更新</a></p><p>请使用FDM BitComet qBittorrent uTorrent等BT下载工具，下载本站电子书资源！首推Free Download Manager下载软件。文件页数>标注页数[分册图书除外]</p></div></body></html>